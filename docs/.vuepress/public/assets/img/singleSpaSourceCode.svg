<?xml version="1.0" standalone="no"?><?xml-stylesheet type="text/css" href="https://www.processon.com/themes/default/mind/icons/icons.css" ?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xlink="http://www.w3.org/1999/xlink" id="mind-svg-con" width="2939.5250244140625px" height="1850px" style="position: absolute; left: 0px; top: 0px; width: 2939.53px; height: 1850px; background: rgb(247, 247, 247); z-index: 999;"><defs></defs><g id="svgbackgroundid"><defs></defs><rect x="0" y="0" width="2939.5250244140625" height="1850" fill="#F7F7F7"></rect></g><g transform="translate(-9873, -8996)" id="sdjakdjak5"><defs></defs><g class="svg-topic-con" transform="translate(0.5,0.5)"><path part="right" sub="true" id="line_812b3a9306dd" d="M 9999.5 9935.5 L 10091.5 9935.5 C 10131.5 9935.5 10131.5 9219.618750572205 10196 9219.618750572205 L 10196 9219.618750572205 L 10453.9375 9219.618750572205" stroke="#DD489D" fill="none" stroke-width="3"></path><path part="right" sub="true" id="line_0291282e6d37" d="M 9999.5 9935.5 L 10091.5 9935.5 C 10131.5 9935.5 10131.5 9945.725012779236 10196 9945.725012779236 L 10196 9945.725012779236 L 10604.524993896484 9945.725012779236" stroke="#02ACF4" fill="none" stroke-width="3"></path><path part="right" sub="true" id="line_78376c5ca10c" d="M 9999.5 9935.5 L 10091.5 9935.5 C 10131.5 9935.5 10131.5 10531.525000572205 10196 10531.525000572205 L 10196 10531.525000572205 L 10387.962509155273 10531.525000572205" stroke="#FA5465" fill="none" stroke-width="3"></path><path part="right" sub="true" id="line_fdcf2e540e64" d="M 9999.5 9935.5 L 10091.5 9935.5 C 10131.5 9935.5 10131.5 10714.737502098083 10196 10714.737502098083 L 10196 10714.737502098083 L 10288 10714.737502098083" stroke="#BE49C4" fill="none" stroke-width="3"></path></g><g class="svg-connection-con" transform="translate(0.5,0.5)"></g><g class="svg-freesums-con" transform="translate(0.5,0.5)"></g><g class="svg-freebos-con" transform="translate(0.5,0.5)"></g></g><g id="fdcf2e540e64"><rect x="323" y="1689.0625" rx="1px" ry="1px" width="92" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="16px" font-weight="normal" fill="rgb(13, 11, 34)" style="font-size:16px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:normal;font-style: normal;"><tspan x="337" y="1710.3375244140625"><tspan>导航事件</tspan></tspan></text></g></g><g id="849d14c11e45"><rect x="491" y="1590" rx="1px" ry="1px" width="370" height="64" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="500" y="1609"><tspan>监听 popstate、hashchange 事件，回调将执行 reroute()：</tspan></tspan><tspan x="500" y="1627.2"><tspan>window.addEventListener("hashchange", urlReroute);</tspan></tspan><tspan x="500" y="1645.4"><tspan>window.addEventListener("popstate", urlReroute);</tspan></tspan></text></g></g><g id="04529d3275cf"><rect x="491" y="1671.5999755859375" rx="1px" ry="1px" width="430" height="64" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="500" y="1690.5999755859375"><tspan style="fill: rgb(244, 67, 54); font-size: inherit;">改写 window.history.pushState和window.history.replaceState方法，</tspan></tspan><tspan x="500" y="1708.7999755859375"><tspan style="fill: rgb(244, 67, 54); font-size: inherit;">使 pushState 和 replaceState 时可以触发 reroute 方法，</tspan></tspan><tspan x="500" y="1726.9999755859376"><tspan style="font-size: inherit;">同时以支持 start(opts) 中的 opts.urlRerouteOnly 属性</tspan></tspan></text></g></g><g id="ab6c9a5c6748"><rect x="491" y="1753.2000732421875" rx="1px" ry="1px" width="592" height="64" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="500" y="1772.2000732421875"><tspan>暴露全局变量 singleSpaNavigate，用以在使用这个方法来轻松的实现在不同注册应用之前的切换，</tspan></tspan><tspan x="500" y="1790.4000732421875"><tspan>而不必需要处理 event.preventDefault(), pushState, triggerAppChange() 等。</tspan></tspan><tspan x="500" y="1808.6000732421876"><tspan>当然也需要用该全局变量来判断微应用所处的环境：基座? or 独立?</tspan></tspan></text></g></g><g id="78376c5ca10c"><rect x="323" y="1505.8500366210938" rx="1px" ry="1px" width="192" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="16px" font-weight="normal" fill="rgb(13, 11, 34)" style="font-size:16px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:normal;font-style: normal;"><tspan x="337" y="1527.125"><tspan>start(opts) 启动微应用</tspan></tspan></text></g></g><g id="0dd56e9c09ba"><rect x="590.9625244140625" y="1483" rx="1px" ry="1px" width="554" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="599.9625244140625" y="1502.9874877929688"><tspan>未调用 start() 函数之前，执行 reroute() 后，微应用只会被加载，不会进行初始化、挂载操作</tspan></tspan></text></g></g><g id="376d2ba88b5c"><rect x="590.9625244140625" y="1529.1875" rx="1px" ry="1px" width="638" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="599.9625244140625" y="1549.1749877929688"><tspan>opts中只存在一个布尔属性 urlRerouteOnly，为真时，pushstate 和 replacestate 不会触发 reroute() 方法</tspan></tspan></text></g></g><g id="0291282e6d37"><rect x="323" y="920.0500183105469" rx="1px" ry="1px" width="409" height="30" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="16px" font-weight="normal" fill="rgb(13, 11, 34)" style="font-size:16px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:normal;font-style: normal;"><tspan x="337" y="941.3250122070312"><tspan>reroute 更新微应用的状态并触发相应的生命周期函数</tspan></tspan></text></g></g><g id="6b301358daf4"><rect x="807.5250244140625" y="419" rx="1px" ry="1px" width="423" height="101" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="816.5250244140625" y="438"><tspan>getAppChanges 将所有的微应用依据状态分为4类：</tspan></tspan><tspan x="816.5250244140625" y="456.2"><tspan>appsToUnload 要移除的应用</tspan></tspan><tspan x="816.5250244140625" y="474.4"><tspan>appsToUnmount 要卸载的应用</tspan></tspan><tspan x="816.5250244140625" y="492.59999999999997"><tspan>appsToLoad 要加载的应用（未加载和正在加载微应用源码/js文件的）</tspan></tspan><tspan x="816.5250244140625" y="510.79999999999995"><tspan>appsToMount 要挂载的应用</tspan></tspan></text></g></g><g id="6d8a72660c2f"><rect x="807.5250244140625" y="979.2875061035156" rx="1px" ry="1px" width="197" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="816.5250244140625" y="999.2749938964844"><tspan>判断基座是否调用了 start 方法</tspan></tspan></text></g></g><g id="f2d90f2a36da"><rect x="1080.487548828125" y="882.8000183105469" rx="1px" ry="1px" width="298" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1089.487548828125" y="902.7875061035156"><tspan>是 =&gt; 4类微应用    执行performAppChanges()</tspan></tspan></text></g></g><g id="d195e61199b8"><rect x="1454.3250732421875" y="537" rx="1px" ry="1px" width="421" height="64" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1463.3250732421875" y="556"><tspan>分发自定义事件（提供给用户在此时处理事情的机会）：</tspan></tspan><tspan x="1463.3250732421875" y="574.2"><tspan>single-spa:before-no-app-change/single-spa:before-app-change</tspan></tspan><tspan x="1463.3250732421875" y="592.4000000000001"><tspan>single-spa:before-routing-event</tspan></tspan></text></g></g><g id="48e3dd7b7e8c"><rect x="1454.3250732421875" y="923.6000061035156" rx="1px" ry="1px" width="307" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1463.3250732421875" y="943.5874938964844"><tspan>校验是否有取消导航的操作（cancelNavigation）</tspan></tspan></text></g></g><g id="e21ec64fb2a1"><rect x="1837.512451171875" y="627.2000007629395" rx="1px" ry="1px" width="48" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1846.512451171875" y="647.1875"><tspan>有</tspan></tspan></text></g></g><g id="542743c6fc39"><rect x="1961.512451171875" y="618.6000003814697" rx="1px" ry="1px" width="262" height="47" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1970.512451171875" y="637.6000022888184"><tspan>终止此次 reroute，并分发一些自定义事件</tspan></tspan><tspan x="1970.512451171875" y="655.8000022888184"><tspan>重新导航到旧url：navigateToUrl(oldUrl)</tspan></tspan></text></g></g><g id="9bd0de5ce537"><rect x="1837.512451171875" y="955.3000183105469" rx="1px" ry="1px" width="48" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1846.512451171875" y="975.2875061035156"><tspan>无</tspan></tspan></text></g></g><g id="3df32e4853c1"><rect x="1971.512451171875" y="773.9000091552734" rx="1px" ry="1px" width="424" height="65" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1996.275146484375" y="792.9000091552734"><tspan>首先执行移除操作，toUnloadPromise(app)，</tspan></tspan><tspan x="1996.275146484375" y="811.1000091552735"><tspan>除非是用户调用 unregisterApplication 方法指定要移除那些 app，</tspan></tspan><tspan x="1996.275146484375" y="829.3000091552735"><tspan>否则一般框架不会给你移除 app 的</tspan></tspan></text></g><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1980.512451171875" y="811.8000030517578"><tspan>1.</tspan></tspan></text></g></g><g id="1001ed937e34"><rect x="2471.612548828125" y="692" rx="1px" ry="1px" width="259" height="228" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="2480.612548828125" y="711"><tspan>// 执行 app.unload() 函数</tspan></tspan><tspan x="2480.612548828125" y="729.2"><tspan>reasonableTime(app, "unload");</tspan></tspan><tspan x="2480.612548828125" y="747.4000000000001"><tspan> </tspan></tspan><tspan x="2480.612548828125" y="765.6000000000001"><tspan>delete appsToUnload[toName(app)];</tspan></tspan><tspan x="2480.612548828125" y="783.8000000000002"><tspan> </tspan></tspan><tspan x="2480.612548828125" y="802.0000000000002"><tspan> // Unloaded apps don't have lifecycles</tspan></tspan><tspan x="2480.612548828125" y="820.2000000000003"><tspan> delete app.bootstrap;</tspan></tspan><tspan x="2480.612548828125" y="838.4000000000003"><tspan> delete app.mount;</tspan></tspan><tspan x="2480.612548828125" y="856.6000000000004"><tspan> delete app.unmount;</tspan></tspan><tspan x="2480.612548828125" y="874.8000000000004"><tspan> delete app.unload;</tspan></tspan><tspan x="2480.612548828125" y="893.0000000000005"><tspan> </tspan></tspan><tspan x="2480.612548828125" y="911.2000000000005"><tspan> app.status = NOT_LOADED;</tspan></tspan></text></g></g><g id="308cbde14415"><rect x="1971.512451171875" y="937.3999938964844" rx="1px" ry="1px" width="413" height="64" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1996.275146484375" y="956.3999938964844"><tspan>然后执行卸载操作，toUnmountPromise(app),</tspan></tspan><tspan x="1996.275146484375" y="974.5999938964844"><tspan>并在卸载完成之后再调用移除操作，看看是否有需要移除的 app，</tspan></tspan><tspan x="1996.275146484375" y="992.7999938964845"><tspan>因为要进行移除之前，必须经过卸载</tspan></tspan></text></g><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1980.512451171875" y="975.3000183105469"><tspan>2.</tspan></tspan></text></g></g><g id="98c076202355"><rect x="2459.925048828125" y="937.3999938964844" rx="1px" ry="1px" width="280" height="64" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="2468.925048828125" y="956.3999938964844"><tspan>// 执行 app.unmount() 函数</tspan></tspan><tspan x="2468.925048828125" y="974.5999938964844"><tspan>reasonableTime(appOrParcel, "unmount");</tspan></tspan><tspan x="2468.925048828125" y="992.7999938964845"><tspan>appOrParcel.status = NOT_MOUNTED;</tspan></tspan></text></g></g><g id="6027399fd8ff"><rect x="1971.512451171875" y="1019" rx="1px" ry="1px" width="594" height="47" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1996.275146484375" y="1038"><tspan>接着在所有的卸载和移除操作之后，分发自定义事件 single-spa:before-mount-routing-event，</tspan></tspan><tspan x="1996.275146484375" y="1056.2"><tspan>表明要开始挂载了</tspan></tspan></text></g><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1980.512451171875" y="1047.8000183105469"><tspan>3.</tspan></tspan></text></g></g><g id="7d7837a9214c"><rect x="1971.512451171875" y="1082.3999938964844" rx="1px" ry="1px" width="577" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1996.275146484375" y="1102.3875122070312"><tspan>不过在移除、卸载的同时，可以同步进行加载操作，toLoadPromise(app)，即 app.loadApp()</tspan></tspan></text></g><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1980.512451171875" y="1103.0874938964844"><tspan>4.</tspan></tspan></text></g></g><g id="740b91add429"><rect x="1971.512451171875" y="1164.9874877929688" rx="1px" ry="1px" width="587" height="46" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1996.275146484375" y="1183.9874877929688"><tspan>最后在加载、卸载、移除所有操作都执行完毕之后，执行挂载操作 tryToBootstrapAndMount，</tspan></tspan><tspan x="1996.275146484375" y="1202.1874877929688"><tspan>通过 shouldBeActive(app) 判断 app 是否需要激活（挂载），决定是否需要挂载</tspan></tspan></text></g><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1980.512451171875" y="1193.7875366210938"><tspan>5.</tspan></tspan></text></g></g><g id="2e46b800422b"><rect x="2634.800048828125" y="1128.5875244140625" rx="1px" ry="1px" width="264" height="120" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="2643.800048828125" y="1147.5875244140625"><tspan>// 执行 app.mount() 函数</tspan></tspan><tspan x="2643.800048828125" y="1165.7875244140625"><tspan>reasonableTime(appOrParcel, "mount");</tspan></tspan><tspan x="2643.800048828125" y="1183.9875244140626"><tspan>appOrParcel.status = MOUNTED;</tspan></tspan><tspan x="2643.800048828125" y="1202.1875244140626"><tspan> </tspan></tspan><tspan x="2643.800048828125" y="1220.3875244140627"><tspan>// 第一次加载还会分发自定义事件</tspan></tspan><tspan x="2643.800048828125" y="1238.5875244140627"><tspan>"single-spa:first-mount"</tspan></tspan></text></g></g><g id="6e08cbf17003"><rect x="1080.487548828125" y="1330.4874877929688" rx="1px" ry="1px" width="545" height="64" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1089.487548828125" y="1349.4874877929688"><tspan>否 =&gt; appsToLoad 类微应用</tspan></tspan><tspan x="1089.487548828125" y="1367.6874877929688"><tspan>执行loadApp() ,对 appsToLoad 中的应用都进行加载：appsToLoad.map(toLoadPromise)</tspan></tspan><tspan x="1089.487548828125" y="1385.8874877929688"><tspan>所以又会逐个执行 toLoadPromise(app)</tspan></tspan></text></g></g><g id="2b0db99b7b0a"><rect x="1711.0750732421875" y="1284.7875366210938" rx="1px" ry="1px" width="247" height="47" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1735.8375244140625" y="1303.7875366210938"><tspan>执行 app.loadApp() 方法进行加载：</tspan></tspan><tspan x="1735.8375244140625" y="1321.9875366210938"><tspan>即获取微应用暴露的对象</tspan></tspan></text></g><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1720.0750732421875" y="1313.5875244140625"><tspan>1.</tspan></tspan></text></g></g><g id="8323f25371b5"><rect x="1711.0750732421875" y="1348.1875" rx="1px" ry="1px" width="442" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1735.8375244140625" y="1368.1749877929688"><tspan>校验微应用暴露的对象中是否有 bootstrap mount unmount 三个方法</tspan></tspan></text></g><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1720.0750732421875" y="1368.875"><tspan>2.</tspan></tspan></text></g></g><g id="d85605092dd1"><rect x="1711.0750732421875" y="1394.375" rx="1px" ry="1px" width="679" height="47" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1735.8375244140625" y="1413.375"><tspan>bootstrap mount unmount 校验通过后保存至app.bootstrap、app.mount、app.unmount上，等待时机调用</tspan></tspan><tspan x="1735.8375244140625" y="1431.575"><tspan>并改变app的状态 app.status = NOT_BOOTSTRAPPED;</tspan></tspan></text></g><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1720.0750732421875" y="1423.1749877929688"><tspan>3.</tspan></tspan></text></g></g><g id="812b3a9306dd"><rect x="323" y="193.94998168945312" rx="1px" ry="1px" width="258" height="30" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="16px" font-weight="normal" fill="rgb(13, 11, 34)" style="font-size:16px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:normal;font-style: normal;"><tspan x="337" y="215.22500610351562"><tspan>registerApplication 注册微应用</tspan></tspan></text></g></g><g id="ac25a09c6779"><rect x="656.9375" y="124.89999389648438" rx="1px" ry="1px" width="280" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="665.9375" y="144.88748168945312"><tspan>sanitizeArguments 处理用户传入的应用参数</tspan></tspan></text></g></g><g id="d322885772b5"><rect x="1013.2125244140625" y="30" rx="1px" ry="1px" width="215" height="64" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1022.2125244140625" y="49"><tspan>validateRegisterWithConfig</tspan></tspan><tspan x="1022.2125244140625" y="67.2"><tspan>validateRegisterWithArguments</tspan></tspan><tspan x="1022.2125244140625" y="85.4"><tspan>验证传入参数的有效性</tspan></tspan></text></g></g><g id="ca6cd4cbbda2"><rect x="1013.2125244140625" y="111.60000610351562" rx="1px" ry="1px" width="290" height="137" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1022.2125244140625" y="130.60000610351562"><tspan>返回格式化好的应用参数对象</tspan></tspan><tspan x="1022.2125244140625" y="148.8000061035156"><tspan>{</tspan></tspan><tspan x="1022.2125244140625" y="167.0000061035156"><tspan>    name: 非空string,</tspan></tspan><tspan x="1022.2125244140625" y="185.2000061035156"><tspan>    loadApp: () =&gt; Promise.resolve(loadApp),</tspan></tspan><tspan x="1022.2125244140625" y="203.40000610351558"><tspan>    activeWhen: (location) =&gt; boolean ,</tspan></tspan><tspan x="1022.2125244140625" y="221.60000610351557"><tspan>    customProps: {},</tspan></tspan><tspan x="1022.2125244140625" y="239.80000610351556"><tspan> }</tspan></tspan></text></g></g><g id="4d70d73dad33"><rect x="656.9375" y="266" rx="1px" ry="1px" width="174" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="665.9375" y="285.98748779296875"><tspan>校验微应用的名称是否重复</tspan></tspan></text></g></g><g id="c4b460c6472f"><rect x="656.9375" y="312.1875" rx="1px" ry="1px" width="695" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="665.9375" y="332.17498779296875"><tspan>保存微应用的信息到变量 apps 中，其中微应用的信息包括 sanitizeArguments 返回的应用参数对象+应用状态等信息</tspan></tspan></text></g></g><g id="e8d781f29478"><rect x="656.9375" y="358.375" rx="1px" ry="1px" width="327" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="665.9375" y="378.3625030517578"><tspan>reroute 更新微应用的状态并触发相应的生命周期函数</tspan></tspan></text></g></g><g transform="translate(323, 1590)" id="sdjakdjak0"><g id="subline_fdcf2e540e64" transform="translate(0.5,0.5)"><path id="line_849d14c11e45" d="M 92 128.7375020980835 C 138 128.7375020980835 130 64.5999984741211 168 64.5999984741211 L 538 64.5999984741211" p="fdcf2e540e64" stroke="#BE49C4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_04529d3275cf" d="M 92 128.7375020980835 C 138 128.7375020980835 130 146.1999740600586 168 146.1999740600586 L 598 146.1999740600586" p="fdcf2e540e64" stroke="#BE49C4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_ab6c9a5c6748" d="M 92 128.7375020980835 C 138 128.7375020980835 130 227.8000717163086 168 227.8000717163086 L 760 227.8000717163086" p="fdcf2e540e64" stroke="#BE49C4" fill="none" stroke-linecap="square" stroke-width="3"></path></g><g transform="translate(0.5,0.5)"></g><g class="svg-summary-con" transform="translate(0.5,0.5)"></g><g class="svg-boundary-con" transform="translate(0.5,0.5)"></g></g><g transform="translate(323, 1483)" id="sdjakdjak1"><g id="subline_78376c5ca10c" transform="translate(0.5,0.5)"><path id="line_0dd56e9c09ba" d="M 191.96250915527344 52.52500057220459 C 237.9625244140625 52.52500057220459 229.96251678466797 29.1875 267.9625244140625 29.1875 L 821.9625244140625 29.1875" p="78376c5ca10c" stroke="#FA5465" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_376d2ba88b5c" d="M 191.96250915527344 52.52500057220459 C 237.9625244140625 52.52500057220459 229.96251678466797 75.375 267.9625244140625 75.375 L 905.9625244140625 75.375" p="78376c5ca10c" stroke="#FA5465" fill="none" stroke-linecap="square" stroke-width="3"></path></g><g transform="translate(0.5,0.5)"></g><g class="svg-summary-con" transform="translate(0.5,0.5)"></g><g class="svg-boundary-con" transform="translate(0.5,0.5)"></g></g><g transform="translate(323, 419)" id="sdjakdjak2"><g id="subline_0291282e6d37" transform="translate(0.5,0.5)"><path id="line_6b301358daf4" d="M 408.5249938964844 530.7250127792358 C 454.5250244140625 530.7250127792358 446.52500915527344 101 484.5250244140625 101 L 907.5250244140625 101" p="0291282e6d37" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_6d8a72660c2f" d="M 408.5249938964844 530.7250127792358 C 454.5250244140625 530.7250127792358 446.52500915527344 589.4750061035156 484.5250244140625 589.4750061035156 L 681.5250244140625 589.4750061035156" p="0291282e6d37" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_f2d90f2a36da" d="M 681.4875335693359 589.4750061035156 C 727.487548828125 589.4750061035156 719.4875411987305 492.9875183105469 757.487548828125 492.9875183105469 L 1055.487548828125 492.9875183105469" p="6d8a72660c2f" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_d195e61199b8" d="M 1055.3250427246094 492.9875183105469 C 1101.3250732421875 492.9875183105469 1093.3250579833984 182.5999984741211 1131.3250732421875 182.5999984741211 L 1552.3250732421875 182.5999984741211" p="f2d90f2a36da" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_48e3dd7b7e8c" d="M 1055.3250427246094 492.9875183105469 C 1101.3250732421875 492.9875183105469 1093.3250579833984 533.7875061035156 1131.3250732421875 533.7875061035156 L 1438.3250732421875 533.7875061035156" p="f2d90f2a36da" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_e21ec64fb2a1" d="M 1438.5125732421875 533.7875061035156 C 1484.512451171875 533.7875061035156 1476.5125122070312 237.38750076293945 1514.512451171875 237.38750076293945 L 1562.512451171875 237.38750076293945" p="48e3dd7b7e8c" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_542743c6fc39" d="M 1562.512451171875 237.38750076293945 C 1608.512451171875 237.38750076293945 1600.512451171875 246.00000190734863 1638.512451171875 246.00000190734863 L 1900.512451171875 246.00000190734863" p="e21ec64fb2a1" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_9bd0de5ce537" d="M 1438.5125732421875 533.7875061035156 C 1484.512451171875 533.7875061035156 1476.5125122070312 565.4875183105469 1514.512451171875 565.4875183105469 L 1562.512451171875 565.4875183105469" p="48e3dd7b7e8c" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_3df32e4853c1" d="M 1562.512451171875 565.4875183105469 C 1618.512451171875 565.4875183105469 1605.512451171875 419.50000762939453 1648.512451171875 419.50000762939453 L 2072.512451171875 419.50000762939453" p="9bd0de5ce537" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_1001ed937e34" d="M 2072.6124572753906 419.50000762939453 C 2118.612548828125 419.50000762939453 2110.612503051758 501.40000915527344 2148.612548828125 501.40000915527344 L 2407.612548828125 501.40000915527344" p="3df32e4853c1" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_308cbde14415" d="M 1562.512451171875 565.4875183105469 C 1618.512451171875 565.4875183105469 1605.512451171875 582.9999923706055 1648.512451171875 582.9999923706055 L 2061.512451171875 582.9999923706055" p="9bd0de5ce537" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_98c076202355" d="M 2060.9249572753906 582.9999923706055 C 2106.925048828125 582.9999923706055 2098.925003051758 582.9999923706055 2136.925048828125 582.9999923706055 L 2416.925048828125 582.9999923706055" p="308cbde14415" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_6027399fd8ff" d="M 1562.512451171875 565.4875183105469 C 1618.512451171875 565.4875183105469 1605.512451171875 646.4000015258789 1648.512451171875 646.4000015258789 L 2242.512451171875 646.4000015258789" p="9bd0de5ce537" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_7d7837a9214c" d="M 1562.512451171875 565.4875183105469 C 1618.512451171875 565.4875183105469 1605.512451171875 692.5874938964844 1648.512451171875 692.5874938964844 L 2225.512451171875 692.5874938964844" p="9bd0de5ce537" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_740b91add429" d="M 1562.512451171875 565.4875183105469 C 1618.512451171875 565.4875183105469 1605.512451171875 792.3874893188477 1648.512451171875 792.3874893188477 L 2235.512451171875 792.3874893188477" p="9bd0de5ce537" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_2e46b800422b" d="M 2235.7999877929688 792.3874893188477 C 2281.800048828125 792.3874893188477 2273.800018310547 828.7875289916992 2311.800048828125 828.7875289916992 L 2575.800048828125 828.7875289916992" p="740b91add429" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_6e08cbf17003" d="M 681.4875335693359 589.4750061035156 C 727.487548828125 589.4750061035156 719.4875411987305 976.0874862670898 757.487548828125 976.0874862670898 L 1302.487548828125 976.0874862670898" p="6d8a72660c2f" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_2b0db99b7b0a" d="M 1302.0750732421875 976.0874862670898 C 1358.0750732421875 976.0874862670898 1345.0750732421875 912.1875381469727 1388.0750732421875 912.1875381469727 L 1635.0750732421875 912.1875381469727" p="6e08cbf17003" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_8323f25371b5" d="M 1302.0750732421875 976.0874862670898 C 1358.0750732421875 976.0874862670898 1345.0750732421875 958.375 1388.0750732421875 958.375 L 1830.0750732421875 958.375" p="6e08cbf17003" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_d85605092dd1" d="M 1302.0750732421875 976.0874862670898 C 1358.0750732421875 976.0874862670898 1345.0750732421875 1021.7750015258789 1388.0750732421875 1021.7750015258789 L 2067.0750732421875 1021.7750015258789" p="6e08cbf17003" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path></g><g transform="translate(0.5,0.5)"></g><g class="svg-summary-con" transform="translate(0.5,0.5)"></g><g class="svg-boundary-con" transform="translate(0.5,0.5)"><path id="bo_bedd037457a0" stroke-linejoin="round" fill="#939aa8" fill-opacity="0.1" stroke="#939aa8" stroke-width="2" stroke-dasharray="6,3" d=" M 1639 264 L 2583 264 L 2583 840 L 1639 840 L 1639 264"></path><path id="bo_d96daba1c8cb" stroke-linejoin="round" fill="#939aa8" fill-opacity="0.1" stroke="#939aa8" stroke-width="2" stroke-dasharray="6,3" d=" M 1379 857 L 2075 857 L 2075 1033 L 1379 1033 L 1379 857"></path></g></g><g transform="translate(323, 30)" id="sdjakdjak3"><g id="subline_812b3a9306dd" transform="translate(0.5,0.5)"><path id="line_ac25a09c6779" d="M 257.9375 193.6187505722046 C 303.9375 193.6187505722046 295.9375 124.08749389648438 333.9375 124.08749389648438 L 613.9375 124.08749389648438" p="812b3a9306dd" stroke="#DD489D" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_d322885772b5" d="M 614.2124938964844 124.08749389648438 C 660.2125244140625 124.08749389648438 652.2125091552734 64.5999984741211 690.2125244140625 64.5999984741211 L 905.2125244140625 64.5999984741211" p="ac25a09c6779" stroke="#DD489D" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_ca6cd4cbbda2" d="M 614.2124938964844 124.08749389648438 C 660.2125244140625 124.08749389648438 652.2125091552734 219.00001525878906 690.2125244140625 219.00001525878906 L 980.2125244140625 219.00001525878906" p="ac25a09c6779" stroke="#DD489D" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_4d70d73dad33" d="M 257.9375 193.6187505722046 C 303.9375 193.6187505722046 295.9375 265.1875 333.9375 265.1875 L 507.9375 265.1875" p="812b3a9306dd" stroke="#DD489D" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_c4b460c6472f" d="M 257.9375 193.6187505722046 C 303.9375 193.6187505722046 295.9375 311.375 333.9375 311.375 L 1028.9375 311.375" p="812b3a9306dd" stroke="#DD489D" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_e8d781f29478" d="M 257.9375 193.6187505722046 C 303.9375 193.6187505722046 295.9375 357.5625 333.9375 357.5625 L 660.9375 357.5625" p="812b3a9306dd" stroke="#DD489D" fill="none" stroke-linecap="square" stroke-width="3"></path></g><g transform="translate(0.5,0.5)"></g><g class="svg-summary-con" transform="translate(0.5,0.5)"></g><g class="svg-boundary-con" transform="translate(0.5,0.5)"></g></g><g transform="translate(30, 906)" id="sdjakdjak4"><g id="subline_root" transform="translate(0.5,0.5)"></g><g transform="translate(0.5,0.5)"></g><g class="svg-summary-con" transform="translate(0.5,0.5)"></g><g class="svg-boundary-con" transform="translate(0.5,0.5)"></g></g><g id="root"><rect x="30" y="906" rx="7px" ry="7px" width="194" height="68" style="fill: #ffffff; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="24px" font-weight="normal" fill="rgb(42, 46, 54)" style="font-size:24px;font-family:微软雅黑;color:#2A2E36;font-style:normal;text-align:left;font-weight:normal;font-style: normal;"><tspan x="68" y="948.3250122070312"><tspan>single-spa</tspan></tspan></text></g></g></svg>
