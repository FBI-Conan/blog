<?xml version="1.0" standalone="no"?><?xml-stylesheet type="text/css" href="https://www.processon.com/themes/default/mind/icons/icons.css" ?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xlink="http://www.w3.org/1999/xlink" id="mind-svg-con" width="2532.687515258789px" height="891.1875228881836px" style="position: absolute; left: 0px; top: 0px; width: 2532.69px; height: 891.188px; background: rgb(247, 247, 247); z-index: 999;"><defs></defs><g id="svgbackgroundid"><defs></defs><rect x="0" y="0" width="2532.687515258789" height="891.1875228881836" fill="#F7F7F7"></rect></g><g transform="translate(-9886.000579833984, -9476.000587463379)" id="sdjakdjak3"><defs></defs><g class="svg-topic-con" transform="translate(0.5,0.5)"><path part="right" sub="true" id="line_812b3a9306dd" d="M 9999.999995640346 9935.999642508372 L 10078.999995640346 9935.999642508372 C 10118.999995640346 9935.999642508372 10118.999995640346 9835.32462338039 10184.000004359654 9835.32462338039 L 10184.000004359654 9835.32462338039 L 10437.687508719308 9835.32462338039" stroke="#DD489D" fill="none" stroke-width="3"></path><path part="right" sub="true" id="line_0291282e6d37" d="M 9999.999995640346 9935.999642508372 L 10078.999995640346 9935.999642508372 C 10118.999995640346 9935.999642508372 10118.999995640346 10265.712153026037 10184.000004359654 10265.712153026037 L 10184.000004359654 10265.712153026037 L 10246.787496294293 10265.712153026037" stroke="#02ACF4" fill="none" stroke-width="3"></path></g><g class="svg-connection-con" transform="translate(0.5,0.5)"></g><g class="svg-freesums-con" transform="translate(0.5,0.5)"></g><g class="svg-freebos-con" transform="translate(0.5,0.5)"></g></g><g id="0291282e6d37"><rect x="298" y="760.0374984741211" rx="1px" ry="1px" width="63" height="30" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="16px" font-weight="normal" fill="rgb(13, 11, 34)" style="font-size:16px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:normal;font-style: normal;"><tspan x="312" y="781.3125228881836"><tspan>start</tspan></tspan></text></g></g><g id="6b301358daf4"><rect x="436.7875061035156" y="691.0000228881836" rx="1px" ry="1px" width="761" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="445.7875061035156" y="710.9875106811523"><tspan>frameworkConfiguration  配置对象，包含用户定义的一些配置，或默认配置如{ prefetch: true, singular: true, sandbox: true };</tspan></tspan></text></g></g><g id="9e3fed764199"><rect x="436.7875061035156" y="783.3750228881836" rx="1px" ry="1px" width="206" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="445.7875061035156" y="803.3625106811523"><tspan>doPrefetchStrategy 预加载函数</tspan></tspan></text></g></g><g id="f1684948fe4c"><rect x="718.75" y="737.1875228881836" rx="1px" ry="1px" width="332" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="727.75" y="757.1750106811523"><tspan>prefetchImmediately 立刻进行预加载剩余微应用资源</tspan></tspan></text></g></g><g id="627c6ace4b0b"><rect x="718.75" y="806.4624862670898" rx="1px" ry="1px" width="543" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="727.75" y="826.4500350952148"><tspan>prefetchAfterFirstMounted  在第一个微应用挂载完成后，且网络良好的情况下进行预加载</tspan></tspan></text></g></g><g id="f65fec5fc9aa"><rect x="1337.6625061035156" y="783.3750228881836" rx="1px" ry="1px" width="396" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1346.6625061035156" y="803.3625106811523"><tspan>single-spa:first-mount  第一个微应用挂载完成之后会触发改事件</tspan></tspan></text></g></g><g id="e671735df30f"><rect x="1337.6625061035156" y="829.5625228881836" rx="1px" ry="1px" width="420" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1346.6625061035156" y="849.5500106811523"><tspan>requestIdleCallback  在浏览器空闲的时候调用传入的回调（预加载）</tspan></tspan></text></g></g><g id="812b3a9306dd"><rect x="298" y="329.6500015258789" rx="1px" ry="1px" width="254" height="30" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="16px" font-weight="normal" fill="rgb(13, 11, 34)" style="font-size:16px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:normal;font-style: normal;"><tspan x="312" y="350.9249954223633"><tspan>registerMicroApps 注册微应用</tspan></tspan></text></g></g><g id="ac25a09c6779"><rect x="627.6875152587891" y="30" rx="1px" ry="1px" width="223" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="636.6875152587891" y="49.98749542236328"><tspan>unregisteredApps 筛选未注册应用</tspan></tspan></text></g></g><g id="4d70d73dad33"><rect x="627.6875152587891" y="326.18750762939453" rx="1px" ry="1px" width="410" height="83" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="636.6875152587891" y="345.18750762939453"><tspan>single-spa/registerApplication 遍历未注册应用进行注册</tspan></tspan><tspan x="636.6875152587891" y="363.3875076293945"><tspan>参数形式：{name, app, activeWhen, customProps}</tspan></tspan><tspan x="636.6875152587891" y="381.5875076293945"><tspan> </tspan></tspan><tspan x="636.6875152587891" y="399.7875076293945"><tspan>其中app 异步函数，返回微应用导出的生命周期钩子，函数内容如右</tspan></tspan></text></g></g><g id="0f28f8165d41"><rect x="1113.3374938964844" y="76.18749618530273" rx="1px" ry="1px" width="253" height="46" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1122.3374938964844" y="95.18749618530273"><tspan>await frameworkStartedDefer.promise</tspan></tspan><tspan x="1122.3374938964844" y="113.38749618530274"><tspan>等待 qiankun/start 方法的调用</tspan></tspan></text></g></g><g id="2501646791bc"><rect x="1113.3374938964844" y="376.0875015258789" rx="1px" ry="1px" width="395" height="46" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1122.3374938964844" y="395.08751678466797"><tspan>loadApp</tspan></tspan><tspan x="1122.3374938964844" y="413.28751678466796"><tspan>返回生命周期 {mount, unmount, boostrap}，支持css 和 js 沙箱</tspan></tspan></text></g></g><g id="28c9786c9476"><rect x="1584.1999816894531" y="139.58749866485596" rx="1px" ry="1px" width="592" height="101" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1593.1999816894531" y="158.58749961853027"><tspan>const { template, execScripts, assetPublicPath } = await importEntry(entry, importEntryOpts);</tspan></tspan><tspan x="1593.1999816894531" y="176.78749961853026"><tspan>importEntry 是 import-html-entry 库的方法，用于获取网站的资源（fetch 方法，需要网站跨域）</tspan></tspan><tspan x="1593.1999816894531" y="194.98749961853025"><tspan>1. template: 去除了 script、link -&gt; style 的模板内容</tspan></tspan><tspan x="1593.1999816894531" y="213.18749961853024"><tspan>2. execScripts: script 内容执行器，可以传入执行上下文（解决 js 沙箱）</tspan></tspan><tspan x="1593.1999816894531" y="231.38749961853023"><tspan>3. assetPublicPath: entry 访问的公共路径，比如：http://localhost:8087/</tspan></tspan></text></g></g><g id="78067e39f431"><rect x="1584.1999816894531" y="257.5875015258789" rx="1px" ry="1px" width="705" height="119" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1593.1999816894531" y="276.5875015258789"><tspan>createElement      根据 template 创建元素，并处理 css 样式隔离</tspan></tspan><tspan x="1593.1999816894531" y="294.7875015258789"><tspan>css 隔离方案：</tspan></tspan><tspan x="1593.1999816894531" y="312.9875015258789"><tspan>&lt;1&gt; sandbox: true -&gt; 依据 html entry 天然支持各微应用之间样式隔离的特性，正常加载进去就行、</tspan></tspan><tspan x="1593.1999816894531" y="331.1875015258789"><tspan>&lt;2&gt; sandbox.strictStyleIsolation: true -&gt; 所有元素放置到 shadow dom 中，不仅可以保证各微应用之间样式隔离，</tspan></tspan><tspan x="1593.1999816894531" y="349.38750152587886"><tspan>        主应用和微应用之间的样式隔离也保证了，但是 shadow dom 还有一些其他问题需要解决 (未来 3.0版本将会移除)</tspan></tspan><tspan x="1593.1999816894531" y="367.58750152587885"><tspan> &lt;3&gt; sandbox.experimentalStyleIsolation: true -&gt; 给所有样式添加选择器规则来限制样式的作用范围（局部样式）</tspan></tspan></text></g></g><g id="1bef994b7233"><rect x="1584.1999816894531" y="393.7874984741211" rx="1px" ry="1px" width="918" height="137" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1593.1999816894531" y="412.7874984741211"><tspan>createSandboxContainer      js 沙箱</tspan></tspan><tspan x="1593.1999816894531" y="430.9874984741211"><tspan>沙箱类型：</tspan></tspan><tspan x="1593.1999816894531" y="449.18749847412107"><tspan>1. SnapshotSandbox   不支持 Proxy 的浏览器 -&gt; 快照形式记录微应用挂载前后的 window 属性，diff 进行恢复和还原</tspan></tspan><tspan x="1593.1999816894531" y="467.38749847412106"><tspan>2. LegacySandbox   特别指明 sandbox.loose 为 true -&gt; 也是利用快照的思想，不过因为使用了 Proxy，可以知道一个微应用激活期间具体加了或者改了那</tspan></tspan><tspan x="1593.1999816894531" y="485.58749847412105"><tspan>些 window 属性，省去了 diff 的过程（未来版本将会弃用）</tspan></tspan><tspan x="1593.1999816894531" y="503.78749847412104"><tspan>3. ProxySandbox     严格模式：sandbox 为布尔值或者 sandbox.loose !== true -&gt; 直接使用空对象去代理 window 对象， 且一切微应用对 window 对象</tspan></tspan><tspan x="1593.1999816894531" y="521.987498474121"><tspan>的属性增加、更改都反映在代理对象上，没有快照恢复还原 window 的过程，支持多应用实例共存的情况，不过目前还不稳定</tspan></tspan></text></g></g><g id="fd95ba73b979"><rect x="1584.1999816894531" y="548.1874923706055" rx="1px" ry="1px" width="545" height="65" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1593.1999816894531" y="567.1874923706055"><tspan>const scriptExports: any = await execScripts(global, sandbox &amp;&amp; !useLooseSandbox);</tspan></tspan><tspan x="1593.1999816894531" y="585.3874923706055"><tspan>scriptExports 含有子应用导出的 bootstrap mount unmount 生命周期钩子对象，</tspan></tspan><tspan x="1593.1999816894531" y="603.5874923706056"><tspan>global 是 js 沙箱的代理对象</tspan></tspan></text></g></g><g id="d9913ae52b1d"><rect x="1584.1999816894531" y="629.7874984741211" rx="1px" ry="1px" width="554" height="29" style="fill: transparent; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="13px" font-weight="400" fill="rgb(13, 11, 34)" style="font-size:13px;font-family:微软雅黑;color:#0D0B22;font-style:normal;text-align:left;font-weight:400;font-style: normal;"><tspan x="1593.1999816894531" y="649.775016784668"><tspan>parcelConfigGetter   返回 {name, bootstrap, mount, unmount} 对象，供 single-spa 调用</tspan></tspan></text></g></g><g transform="translate(298, 691.0000228881836)" id="sdjakdjak0"><g id="subline_0291282e6d37" transform="translate(0.5,0.5)"><path id="line_6b301358daf4" d="M 62.78749193464007 98.71249280657088 C 108.78751482282368 98.71249280657088 100.78750337873188 29.18750163487026 138.78751482282368 29.18750163487026 L 899.7875148228237 29.18750163487026" p="0291282e6d37" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_9e3fed764199" d="M 62.78749193464007 98.71249280657088 C 108.78751482282368 98.71249280657088 100.78750337873188 121.5625103541783 138.78751482282368 121.5625103541783 L 344.7875148228237 121.5625103541783" p="0291282e6d37" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_f1684948fe4c" d="M 344.7500174386161 121.5625103541783 C 390.7500185285296 121.5625103541783 382.7500179835729 75.37498419625419 420.7500185285296 75.37498419625419 L 752.7500185285296 75.37498419625419" p="9e3fed764199" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_627c6ace4b0b" d="M 344.7500174386161 121.5625103541783 C 390.7500185285296 121.5625103541783 382.7500179835729 144.64997373308455 420.7500185285296 144.64997373308455 L 963.7500185285296 144.64997373308455" p="9e3fed764199" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_f65fec5fc9aa" d="M 963.6625725882394 144.64997373308455 C 1009.6625627790179 144.64997373308455 1001.6625676836286 121.5625103541783 1039.662562779018 121.5625103541783 L 1435.662562779018 121.5625103541783" p="627c6ace4b0b" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_e671735df30f" d="M 963.6625725882394 144.64997373308455 C 1009.6625627790179 144.64997373308455 1001.6625676836286 167.74999291556225 1039.662562779018 167.74999291556225 L 1459.662562779018 167.74999291556225" p="627c6ace4b0b" stroke="#02ACF4" fill="none" stroke-linecap="square" stroke-width="3"></path></g><g transform="translate(0.5,0.5)"></g><g class="svg-summary-con" transform="translate(0.5,0.5)"></g><g class="svg-boundary-con" transform="translate(0.5,0.5)"></g></g><g transform="translate(298, 30)" id="sdjakdjak1"><g id="subline_812b3a9306dd" transform="translate(0.5,0.5)"><path id="line_ac25a09c6779" d="M 253.68750435965404 329.32498196193154 C 299.6875217982701 329.32498196193154 291.68751307896207 29.187496185302738 329.6875217982701 29.187496185302738 L 552.6875217982702 29.187496185302738" p="812b3a9306dd" stroke="#DD489D" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_4d70d73dad33" d="M 253.68750435965404 329.32498196193154 C 299.6875217982701 329.32498196193154 291.68751307896207 378.9874888828823 329.6875217982701 378.9874888828823 L 739.6875217982702 378.9874888828823" p="812b3a9306dd" stroke="#DD489D" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_0f28f8165d41" d="M 739.3374851771764 378.9874888828823 C 785.3375026157925 378.9874888828823 777.3374938964844 92.58750588553292 815.3375026157925 92.58750588553292 L 1068.3375026157923 92.58750588553292" p="4d70d73dad33" stroke="#DD489D" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_2501646791bc" d="M 739.3374851771764 378.9874888828823 C 785.3375026157925 378.9874888828823 777.3374938964844 392.48750632149836 815.3375026157925 392.48750632149836 L 1210.3375026157923 392.48750632149836" p="4d70d73dad33" stroke="#DD489D" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_28c9786c9476" d="M 1210.2000863211497 392.48750632149836 C 1256.2001037597656 392.48750632149836 1248.2000950404577 210.58750370570593 1286.2001037597656 210.58750370570593 L 1878.2001037597656 210.58750370570593" p="2501646791bc" stroke="#DD489D" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_78067e39f431" d="M 1210.2000863211497 392.48750632149836 C 1256.2001037597656 392.48750632149836 1248.2000950404577 346.78750937325617 1286.2001037597656 346.78750937325617 L 1991.2001037597656 346.78750937325617" p="2501646791bc" stroke="#DD489D" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_1bef994b7233" d="M 1210.2000863211497 392.48750632149836 C 1256.2001037597656 392.48750632149836 1248.2000950404577 501.1875337873186 1286.2001037597656 501.1875337873186 L 2204.2001037597656 501.1875337873186" p="2501646791bc" stroke="#DD489D" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_fd95ba73b979" d="M 1210.2000863211497 392.48750632149836 C 1256.2001037597656 392.48750632149836 1248.2000950404577 582.787461417062 1286.2001037597656 582.787461417062 L 1831.2001037597656 582.787461417062" p="2501646791bc" stroke="#DD489D" fill="none" stroke-linecap="square" stroke-width="3"></path><path id="line_d9913ae52b1d" d="M 1210.2000863211497 392.48750632149836 C 1256.2001037597656 392.48750632149836 1248.2000950404577 628.9749957493373 1286.2001037597656 628.9749957493373 L 1840.2001037597656 628.9749957493373" p="2501646791bc" stroke="#DD489D" fill="none" stroke-linecap="square" stroke-width="3"></path></g><g transform="translate(0.5,0.5)"></g><g class="svg-summary-con" transform="translate(0.5,0.5)"></g><g class="svg-boundary-con" transform="translate(0.5,0.5)"></g></g><g transform="translate(30, 425.99999237060547)" id="sdjakdjak2"><g id="subline_root" transform="translate(0.5,0.5)"></g><g transform="translate(0.5,0.5)"></g><g class="svg-summary-con" transform="translate(0.5,0.5)"></g><g class="svg-boundary-con" transform="translate(0.5,0.5)"></g></g><g id="root"><rect x="30" y="425.99999237060547" rx="7px" ry="7px" width="168" height="68" style="fill: #ffffff; stroke:none;"></rect><g><text text-anchor="start" align="top" anchor="start" font-size="24px" font-weight="normal" fill="rgb(42, 46, 54)" style="font-size:24px;font-family:微软雅黑;color:#2A2E36;font-style:normal;text-align:left;font-weight:normal;font-style: normal;"><tspan x="68" y="468.3250045776367"><tspan>qiankun</tspan></tspan></text></g></g></svg>
